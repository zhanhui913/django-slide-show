{% extends "image/base.html" %}

{% block page_title %} Image Detail {% endblock %}

{% block header_title %} Slide Show {% endblock %}

{% block page_content %}

	<div class="col-lg-1 col-md-12 col-sm-12">
		<a href="/">
			<button type="button" class="btn btn-default btn-lg">
  				<span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>Back
			</button>
		</a>
	</div>

	<div class="col-lg-8 col-md-12 col-sm-12">
		<img class="img-rounded" src="{{ image.path.url }}"/>
	</div>
	<div class = "col-lg-3 col-md-12 col-sm-12">
		<!-- Caption -->
		<div class = "col-lg-12">
			<h3> {{ image.caption }}</h3>
		</div>
		
		<!-- Description -->
		<div class = "col-lg-12 col-md-12 col-sm-12">
			<p> {{ image.description }}</p>
		</div>

		<!-- Upload Date -->
		<div class = "col-lg-12">
			<p> {{ image.upload_date }}</p>
		</div>		

		<!-- favorite form-->
		<div class= "col-lg-12 col-md-12 col-sm-12">
			{% if image.favorite %}
			Already favorited
			{% else %}
			<input id="fav" class="btn btn-primary btn-lg btn-block" value="Add favorite" type="buton">
			{% endif %}
		</div>
	</div>

	<script>
		// using jQuery
		function getCookie(name) {
		    var cookieValue = null;
		    if (document.cookie && document.cookie != '') {
		        var cookies = document.cookie.split(';');
		        for (var i = 0; i < cookies.length; i++) {
		            var cookie = jQuery.trim(cookies[i]);
		            // Does this cookie string begin with the name we want?
		            if (cookie.substring(0, name.length + 1) == (name + '=')) {
		                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
		                break;
		            }
		        }
		    }
		    return cookieValue;
		}

		$(function () {
	    	$.ajaxSetup({
	        	headers: { "X-CSRFToken": getCookie("csrftoken") }
	    	});
		});

		$(document).ready(document_ready);
		function document_ready() {
		    $("#fav").click(function () {
		        $.ajax({
		            type: "post",
		            url: "{% url 'image:imageDetail' image.id %}",
		            data: {
		            	"pk":4
		            },
		            success: function (data) {
		                alert(data);
		            },
		            error: function (data) {
		                alert("Error. " + "Status: " + data.status + " Text: " + data.statusText);
		            }
		        });
		    })
		}
	</script>

{% endblock %}